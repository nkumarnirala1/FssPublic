<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facade Structural Services</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<!-- Fixed Header -->
<header class="fixed-header">
    <div class="header-left">
        <img src="/images/fsslogo.jpeg" alt="FSS Logo" class="logo">
        <h1>Facade Structural Services</h1>
    </div>
    <div class="header-right">
        <form th:action="@{/estimation}" method="get">
            <button type="submit" class="header-btn estimation-btn">Estimation</button>
        </form>
        <form th:action="@{/download-pdf}" method="get">
            <button type="submit" class="header-btn download-btn">Download PDF</button>
        </form>
        <form th:action="@{/logout}" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <button type="submit" class="header-btn logout-btn">⏻Logout</button>
        </form>
    </div>
</header>

<!-- Main Content Wrapper -->
<div class="main-wrapper">
    <!-- Left Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-buttons">
            <button class="tab-btn active" id="semi-tab" onclick="showForm('semi')">
                Semi Unitized
            </button>
            <button class="tab-btn" id="fully-tab" onclick="showForm('fully')">
                Fully Unitized
            </button>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="content-area">
        <div class="content-container">
            <!-- Forms Container -->
            <div class="forms-container">
                <!-- Semi Unitized Form -->
                <div id="semi-form" class="form-section">
                    <div th:if="${!(showMullionForm?:false) and !(showTransomForm?:false)}">
                        <h2>Semi Unitized Glazing Load Input</h2>
                        <form th:action="@{/calculate}" method="post" th:object="${input}" class="glazing-form">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                            <label for="typeOfGlazing">Type of Glazing</label>
                            <select id="typeOfGlazing" th:field="*{typeOfGlazing}" required>
                                <option value="" disabled selected>Select Glazing Type</option>
                                <option value="SLIDING WINDOW">SLIDING WINDOW</option>
                                <option value="IN TO IN SEMI UNITIZED">IN TO IN SEMI UNITIZED</option>
                                <option value="SINGLE BRACKET SEMI UNITIZED">SINGLE BRACKET SEMI UNITIZED</option>
                                <option value="DOUBLE BRACKET SEMI UNITIZED">DOUBLE BRACKET SEMI UNITIZED</option>
                            </select>

                            <label for="unsupportedLength">Unsupported Length (mm)</label>
                            <input type="number" id="unsupportedLength" name="unsupportedLength" th:value="*{unsupportedLength}" placeholder="Enter length in mm" required/>

                            <label for="gridLength">Grid Length (mm)</label>
                            <input type="number" id="gridLength" name="gridLength" th:value="*{gridLength}" placeholder="Enter length in mm" required/>

                            <label for="windPressure">Wind Pressure (kN/m²)</label>
                            <input type="number" id="windPressure" name="windPressure" th:value="*{windPressure}" step="0.01" placeholder="Enter pressure" required/>

                            <label for="stackBracket">Stack Bracket (mm)</label>
                            <input type="number" id="stackBracket" name="stackBracket" th:value="*{stackBracket}" placeholder="Enter bracket size" required/>

                            <button type="submit">Calculate</button>
                        </form>
                    </div>
                </div>

                <!-- Fully Unitized Form (Initially Hidden) -->
                <div id="fully-form" class="form-section hidden">
                    <div th:if="${!(showMullionForm?:false) and !(showTransomForm?:false)}">
                        <h2>Fully Unitized Glazing Load Input</h2>
                        <form th:action="@{/calculateFully}" method="post" th:object="${input}" class="glazing-form">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                            <label for="fullyTypeOfGlazing">Unitized Type</label>
                            <select id="fullyTypeOfGlazing" name="typeOfGlazing" required>
                                <option value="" disabled selected>Select Unitized Type</option>
                                <option value="UNITIZED SYSTEM">UNITIZED SYSTEM</option>
                                <option value="UNITIZED WITH FIN">UNITIZED WITH FIN</option>
                            </select>

                            <label for="fullyUnsupportedLength">Unsupported Length (mm)</label>
                            <input type="number" id="fullyUnsupportedLength" name="unsupportedLength" th:value="*{unsupportedLength}" placeholder="Enter length in mm" required/>

                            <label for="fullyGridLength">Grid Length (mm)</label>
                            <input type="number" id="fullyGridLength" name="gridLength" th:value="*{gridLength}" placeholder="Enter length in mm" required/>

                            <label for="fullyWindPressure">Wind Pressure (kN/m²)</label>
                            <input type="number" id="fullyWindPressure" name="windPressure" th:value="*{windPressure}" step="0.01" placeholder="Enter pressure" required/>

                            <button type="submit">Calculate</button>
                        </form>
                    </div>
                </div>

                <!-- Mullion Profile Check Form -->
                <div th:if="${showMullionForm?:false}">
                    <h2>Mullion Profile Check</h2>
                    <form th:action="@{/submitMullionProfile}" method="post" class="profile-form" th:object="${mullionInput}">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                        <label for="glassThickness">Glass Thickness (mm)</label>
                        <input type="number" step="0.01" id="glassThickness" th:field="*{glassThickness}" th:value="${glassThickness}" required/>

                        <label for="crossSectionalArea">Cross Sectional Area (cm²)</label>
                        <input type="number" step="0.01" id="crossSectionalArea" th:field="*{crossSectionalArea}" th:value="${crossSectionalArea}" required/>

                        <label for="transomToTransomDistance">Transom to Transom Distance (mm)</label>
                        <input type="number" step="0.01" id="transomToTransomDistance" th:field="*{transomToTransomDistance}" th:value="${transomToTransomDistance}" required/>

                        <label for="b">Section Width b (mm)</label>
                        <input type="number" step="0.01" id="b" th:field="*{b}" th:value="${b}" required/>

                        <label for="a">Depth of Section a (mm)</label>
                        <input type="number" step="0.01" id="a" th:field="*{a}" th:value="${a}" required/>

                        <label for="t2">t₂ (mm)</label>
                        <input type="number" step="0.01" id="t2" th:field="*{t2}" th:value="${t2}" required/>

                        <label for="t1">t₁ (mm)</label>
                        <input type="number" step="0.01" id="t1" th:field="*{t1}" th:value="${t1}" required/>

                        <label for="iyy">Iyy (cm⁴)</label>
                        <input type="number" step="0.01" id="iyy" th:field="*{iyy}" th:value="${iyy}" required/>

                        <label for="boundingboxy">Bounding Box Y (mm)</label>
                        <input type="number" step="0.01" id="boundingboxy" th:field="*{boundingboxy}" th:value="${boundingboxy}" required/>

                        <label for="userIxx">User Ixx (×10¹⁰ mm⁴)</label>
                        <input type="number" step="0.01" id="userIxx" th:field="*{userIxx}" th:value="${userIxx}" required/>

                        <button type="submit">Submit Mullion Profile</button>
                    </form>
                </div>

                <!-- Transom Profile Check Form -->
                <div th:if="${showTransomForm?:false}">
                    <h2>Transom Profile Check</h2>
                    <form th:action="@{/submitTransomProfile}" method="post" class="profile-form" th:object="${transomInput}">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                        <label for="transomTopPanelHeight">Top Panel Height (mm)</label>
                        <input type="number" step="0.01" id="transomTopPanelHeight" th:field="*{transomTopPanelHeight}" th:value="${transomTopPanelHeight}" required/>

                        <label for="transomBottomPanelHeight">Bottom Panel Height (mm)</label>
                        <input type="number" step="0.01" id="transomBottomPanelHeight" th:field="*{transomBottomPanelHeight}" th:value="${transomBottomPanelHeight}" required/>

                        <label for="depthOfSectionTransom">Depth of Section (mm)</label>
                        <input type="number" step="0.01" id="depthOfSectionTransom" th:field="*{depthOfSectionTransom}" th:value="${depthOfSectionTransom}" required/>

                        <label for="t2Transom">t₂ (mm)</label>
                        <input type="number" step="0.01" id="t2Transom" th:field="*{t2Transom}" th:value="${t2Transom}" required/>

                        <label for="t1Transom">t₁ (mm)</label>
                        <input type="number" step="0.01" id="t1Transom" th:field="*{t1Transom}" th:value="${t1Transom}" required/>

                        <label for="transomIxx">Ixx (cm⁴)</label>
                        <input type="number" step="0.01" id="transomIxx" th:field="*{transomIxx}" th:value="${transomIxx}" required/>

                        <label for="transomIyy">Iyy (cm⁴)</label>
                        <input type="number" step="0.01" id="transomIyy" th:field="*{transomIyy}" th:value="${transomIyy}" required/>

                        <label for="transomBoundingBoxY">Bounding Box Y (mm)</label>
                        <input type="number" step="0.01" id="transomBoundingBoxY" th:field="*{transomBoundingBoxY}" th:value="${transomBoundingBoxY}" required/>

                        <label for="transomCrossSectionArea">Cross Sectional Area (cm²)</label>
                        <input type="number" step="0.01" id="transomCrossSectionArea" th:field="*{transomCrossSectionArea}" th:value="${transomCrossSectionArea}" required/>

                        <label for="transomUnsupportedLength">Unsupported Length (mm)</label>
                        <input type="number" step="0.01" id="transomUnsupportedLength" th:field="*{transomUnsupportedLength}" th:value="${transomUnsupportedLength}" required/>

                        <label for="sectionWidthB">Section Width b (mm)</label>
                        <input type="number" step="0.01" id="sectionWidthB" th:field="*{sectionWidthB}" th:value="${sectionWidthB}" required/>

                        <button type="submit">Submit Transom Profile</button>
                    </form>
                </div>
            </div>

            <!-- Results Panel -->
            <div class="result-wrapper" th:if="${Ixx != null}">
                <div class="result-container">
                    <h2>Calculated Result for given input -</h2>
                    <p th:text="'Required Ixx: ' + ${Ixx} + ' ×10¹⁰ mm⁴'"></p>
                    <p th:text="'Allowable deflection: ' + ${df} + ' mm'"></p>
                    <p th:text="'Bending Moment: ' + ${bm} + ' kN·m'"></p>
                </div>

                <form th:action="@{/calculate-deflection}" method="post" class="deflection-form">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <label for="userIxx">Enter Custom Ixx (×10¹⁰ mm⁴):</label>
                    <input type="number" id="userIxx" name="userIxx" step="0.01" th:value="*{userIxx}" required/>
                    <button type="submit">Calculate Deflection</button>
                </form>

                <div class="result-container-deflection" th:if="${cf != null}">
                    <p th:text="'Calculated Deflection for entered Ixx: ' + ${cf} + ' mm'"></p>
                </div>

                <form th:action="@{/checkMullion}" method="post">
                    <button type="submit" class="checkMullion-btn">Check for Mullion Profile</button>
                </form>

                <form th:action="@{/checkTransom}" method="post">
                    <button type="submit" class="checkTransom-btn">Check for Transom Profile</button>
                </form>
            </div>

            <!-- Error Box -->
            <div class="result-wrapper" th:if="${error}">
                <div class="error-box">
                    <img class="error-icon" src="/images/error_img.png" alt="Error Icon">
                    <p th:text="${error}"></p>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
    function showForm(type) {
        // Hide all forms
        document.getElementById('semi-form').classList.add('hidden');
        document.getElementById('fully-form').classList.add('hidden');

        // Remove active class from all buttons
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));

        // Show selected form and activate its button
        if (type === 'semi') {
            document.getElementById('semi-form').classList.remove('hidden');
            document.getElementById('semi-tab').classList.add('active');
        } else {
            document.getElementById('fully-form').classList.remove('hidden');
            document.getElementById('fully-tab').classList.add('active');
        }
    }

    // Set default form on page load
    window.onload = function() {
        showForm('semi');
    };
</script>
</body>
</html>